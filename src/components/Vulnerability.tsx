import type { VulnerabilityProps } from '../types/vulnerability';
import Button from './Button';
import classNames from 'classnames';

export default function Vulnerability({ vulnerability, onResolve, onView }: VulnerabilityProps) {

  function getSeverityClass(severity: string): string {
    switch (severity.toUpperCase()) {
      case 'CRITICAL':
        return 'bg-red-600 text-white';
      case 'HIGH':
        return 'bg-orange-600 text-white';
      case 'MEDIUM':
        return 'bg-yellow-400 text-black';
      case 'LOW':
        return 'bg-green-500 text-white';
      case 'INFO':
        return 'bg-blue-500 text-white';
      default:
        return '';
    }
  }

  return (
    <tr className='bg-slate-500 hover:bg-gray-100 '>
      <td className={classNames('border px-4 py-2 text-center', getSeverityClass(vulnerability.severity))}>{vulnerability.severity}</td>
      <td className="border px-4 py-2">{vulnerability.name}</td>
      <td className="border px-4 py-2">{vulnerability.category}</td>
      <td className="border px-4 py-2">{vulnerability.description}</td>
      <td className="border-t px-4 py-2 flex gap-2">
        <Button classString="bg-green-600 rounded" onClick={onResolve} label="Resolve" />
        <Button classString="bg-red-500 rounded" onClick={onView} label="View" />
      </td>
    </tr>
  );
}
